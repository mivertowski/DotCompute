{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "DotCompute Security Policy Configuration",
  "description": "Comprehensive security configuration for plugin validation",
  
  "RequireDigitalSignature": true,
  "RequireStrongName": true,
  "MinimumSecurityLevel": "Medium",
  "EnableMetadataAnalysis": true,
  "EnableMalwareScanning": true,
  "MaxAssemblySize": 52428800,
  
  "TrustedPublishers": [
    "/* Example certificate thumbprints - replace with actual trusted publisher certificates */",
    "1234567890ABCDEF1234567890ABCDEF12345678",
    "ABCDEF1234567890ABCDEF1234567890ABCDEF12"
  ],
  
  "BlockedAssemblies": [
    "/* Example blocked assembly names or hashes */",
    "malicious-assembly.dll",
    "FEDCBA0987654321FEDCBA0987654321FEDCBA09"
  ],
  
  "DirectoryPolicies": {
    "/trusted/plugins": "High",
    "/system/plugins": "Critical",
    "/temp": "Low",
    "/downloads": "Medium"
  },
  
  "SecurityRules": {
    "FileSizeCheck": {
      "Enabled": true,
      "MaxSizeBytes": 52428800,
      "WarningSizeBytes": 41943040
    },
    
    "DigitalSignatureValidation": {
      "Enabled": true,
      "RequireTrustedPublisher": true,
      "AllowSelfSignedForDevelopment": false,
      "CheckRevocation": true,
      "RequireValidChain": true
    },
    
    "StrongNameValidation": {
      "Enabled": true,
      "MinimumKeySize": 1024,
      "RequirePublicKeyToken": true,
      "AllowTestKeys": false
    },
    
    "MetadataAnalysis": {
      "Enabled": true,
      "SuspiciousNamespaceThreshold": 5,
      "SuspiciousTypeThreshold": 3,
      "CheckForUnsafeCode": true,
      "CheckForDynamicCodeGeneration": true,
      "BlockedNamespaces": [
        "System.Diagnostics.Process",
        "System.IO.File",
        "Microsoft.Win32.Registry"
      ]
    },
    
    "MalwareScanning": {
      "Enabled": true,
      "EnableWindowsDefender": true,
      "EnablePatternMatching": true,
      "EnableBehavioralAnalysis": true,
      "ScanTimeout": "00:02:00",
      "MaxConcurrentScans": 3,
      "SuspiciousPatterns": [
        "CreateProcess",
        "WriteFile",
        "RegOpenKey",
        "VirtualAlloc",
        "LoadLibrary",
        "GetProcAddress"
      ],
      "BehavioralRiskThreshold": 30
    }
  },
  
  "CodeAccessSecurity": {
    "Enabled": true,
    "DefaultPermissionSet": "Internet",
    "CustomPermissions": {
      "FileIOPermission": {
        "Read": ["/app/data", "/app/temp"],
        "Write": ["/app/temp"],
        "Append": ["/app/logs"]
      },
      "SecurityPermission": {
        "Execution": true,
        "SkipVerification": false,
        "UnmanagedCode": false
      },
      "ReflectionPermission": {
        "ReflectionEmit": false,
        "MemberAccess": true
      },
      "NetworkPermission": {
        "Connect": ["https://api.example.com"],
        "Accept": []
      }
    }
  },
  
  "Monitoring": {
    "LogSecurityEvents": true,
    "LogLevel": "Information",
    "AlertOnViolations": true,
    "AlertThresholds": {
      "MaxViolationsPerHour": 10,
      "MaxFailedValidationsPerHour": 5
    }
  },
  
  "DevelopmentSettings": {
    "AllowUnsignedInDebug": false,
    "AllowSelfSignedCertificates": false,
    "SkipMalwareScanningForLocalFiles": false,
    "EnableVerboseLogging": true
  }
}