// Copyright (c) 2025 Michael Ivertowski
// Licensed under the MIT License. See LICENSE file in the project root for license information.

using DotCompute.Algorithms.Security.Enums;

namespace DotCompute.Algorithms.Security.Vulnerabilities;

/// <summary>
/// Represents a specific vulnerability found in a software package.
/// Contains comprehensive information about the security issue including severity, dates, and references.
/// </summary>
public sealed class PackageVulnerability
{
    /// <summary>
    /// Gets or sets the unique identifier for this vulnerability.
    /// May be a CVE ID, GHSA ID, or other database-specific identifier.
    /// </summary>
    /// <value>The vulnerability identifier as a string.</value>
    public required string Id { get; set; }

    /// <summary>
    /// Gets or sets the Common Vulnerabilities and Exposures (CVE) identifier if applicable.
    /// Provides standardized reference for the vulnerability across different databases.
    /// </summary>
    /// <value>The CVE identifier as a string, or null if not available.</value>
    public string? CveId { get; set; }

    /// <summary>
    /// Gets or sets the title or summary of the vulnerability.
    /// Provides a brief description of the security issue.
    /// </summary>
    /// <value>The vulnerability title as a string.</value>
    public required string Title { get; set; }

    /// <summary>
    /// Gets or sets the detailed description of the vulnerability.
    /// Explains the nature of the security issue, its impact, and potential exploitation methods.
    /// </summary>
    /// <value>The vulnerability description as a string.</value>
    public string Description { get; set; } = string.Empty;

    /// <summary>
    /// Gets or sets the severity level of the vulnerability.
    /// Indicates the potential impact and urgency for remediation.
    /// </summary>
    /// <value>The vulnerability severity from the VulnerabilitySeverity enumeration.</value>
    public VulnerabilitySeverity Severity { get; set; }

    /// <summary>
    /// Gets or sets the date when the vulnerability was first published.
    /// Indicates when the security issue became publicly known.
    /// </summary>
    /// <value>The published date as a DateTime.</value>
    public DateTime PublishedDate { get; set; }

    /// <summary>
    /// Gets or sets the date when the vulnerability information was last modified.
    /// Indicates the freshness of the vulnerability data.
    /// </summary>
    /// <value>The modified date as a DateTime.</value>
    public DateTime ModifiedDate { get; set; }

    /// <summary>
    /// Gets or sets the source database or service that provided this vulnerability information.
    /// Identifies where the vulnerability data originated (e.g., "NVD", "GitHub Advisory", "OSS Index").
    /// </summary>
    /// <value>The vulnerability source as a string.</value>
    public required string Source { get; set; }

    /// <summary>
    /// Gets or sets the list of reference URLs providing additional information.
    /// Contains links to security advisories, patches, documentation, or related resources.
    /// </summary>
    /// <value>A list of reference URLs as strings.</value>
    public List<string> References { get; set; } = [];

    /// <summary>
    /// Gets or sets the version ranges affected by this vulnerability.
    /// Specifies which versions of the package are vulnerable to this security issue.
    /// </summary>
    /// <value>A list of affected version range strings.</value>
    public List<string> AffectedVersions { get; set; } = [];
}