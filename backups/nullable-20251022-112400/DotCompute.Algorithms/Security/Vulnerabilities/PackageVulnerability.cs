// Copyright (c) 2025 Michael Ivertowski
// Licensed under the MIT License. See LICENSE file in the project root for license information.

using DotCompute.Algorithms.Security.Enums;

namespace DotCompute.Algorithms.Security.Vulnerabilities;

/// <summary>
/// Represents a security vulnerability found in a package.
/// Contains comprehensive information about the vulnerability including severity, references, and affected versions.
/// </summary>
public sealed class PackageVulnerability
{
    /// <summary>
    /// Gets or sets the unique vulnerability identifier.
    /// This could be a CVE ID, GHSA ID, or other vulnerability database identifier.
    /// </summary>
    public required string Id { get; set; }

    /// <summary>
    /// Gets or sets the CVE (Common Vulnerabilities and Exposures) ID if applicable.
    /// Standardized identifier used across multiple vulnerability databases.
    /// </summary>
    public string? CveId { get; set; }

    /// <summary>
    /// Gets or sets the vulnerability title or summary.
    /// Brief description of the security issue.
    /// </summary>
    public required string Title { get; set; }

    /// <summary>
    /// Gets or sets the detailed description of the vulnerability.
    /// Provides comprehensive information about the security issue and its implications.
    /// </summary>
    public string Description { get; set; } = string.Empty;

    /// <summary>
    /// Gets or sets the severity level of the vulnerability.
    /// Indicates the potential impact and urgency of addressing this security issue.
    /// </summary>
    public VulnerabilitySeverity Severity { get; set; }

    /// <summary>
    /// Gets or sets the date when the vulnerability was first published.
    /// </summary>
    public DateTime PublishedDate { get; set; }

    /// <summary>
    /// Gets or sets the date when the vulnerability information was last modified.
    /// </summary>
    public DateTime ModifiedDate { get; set; }

    /// <summary>
    /// Gets or sets the source database or service that reported this vulnerability.
    /// Examples: "NVD", "GitHub Advisory", "OSS Index", "Local Database"
    /// </summary>
    public required string Source { get; set; }

    /// <summary>
    /// Gets or sets the list of reference URLs for additional information.
    /// May include links to advisories, patches, or detailed explanations.
    /// </summary>
    public IList<string> References { get; } = [];

    /// <summary>
    /// Gets or sets the list of package version ranges affected by this vulnerability.
    /// Helps determine if a specific package version is vulnerable.
    /// </summary>
    public IList<string> AffectedVersions { get; } = [];
}